@import "tailwindcss";

/* === Your original design system (unchanged) === */
:root {
    --bg: #ffffff;
    --text: #111827;
    --text-strong: #0b0f19;
    --panel: #f6f8fa;
    --user: #e8f0fe;
    --border: #e5e7eb;
    --code-bg: #0f172a0f;
    --shadow: 0 6px 24px rgba(0,0,0,.08), 0 2px 6px rgba(0,0,0,.06);
    --scroll-track: #f0f2f5;
    --scroll-thumb: #cbd5e1;
    color-scheme: light;
}

@media (prefers-color-scheme: dark) {
    :root {
        --bg: #0b0f19;
        --text: #e5e7eb;
        --text-strong: #f3f4f6;
        --panel: #0f172a;
        --user: #1f2937;
        --border: #374151;
        --code-bg: #111827;
        --shadow: 0 6px 24px rgba(0,0,0,.4), 0 2px 6px rgba(0,0,0,.3);
        --scroll-track: #0e1424;
        --scroll-thumb: #374151;
        color-scheme: dark;
    }
}

/* Native selects (Radix Select is separate) */
select, option {
    background: var(--panel);
    color: var(--text-strong);
}

* { box-sizing: border-box; }
html, body, #root {
    height: 100%;
    margin: 0;
    background: var(--bg);
    color: var(--text);
    font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial;
}

.container { max-width: min(1200px, 96vw); margin: 0 auto; }

/* Header */
.header {
    background: var(--panel);
    border-bottom: 1px solid var(--border);
}

/* Fixed chat viewport between header & composer */
.chat-viewport {
    position: fixed;
    left: 0; right: 0;
    /* top/bottom set inline by Chat.tsx */
    overflow: hidden;
    z-index: 0;
}

/* Inner scroller that actually scrolls */
.chat {
    display: flex;
    flex-direction: column;
    align-items: flex-end;   /* right-align all messages */
    gap: 12px;
    padding: 16px;
    overflow-y: auto;
    overflow-x: hidden;
    height: 100%;
    direction: ltr;          /* keep scrollbar on the RIGHT in RTL locales */
    scroll-snap-type: y mandatory;
    scrollbar-gutter: stable;
}

/* Modern scrollbar styling */
.chat { scrollbar-width: thin; scrollbar-color: var(--scroll-thumb) var(--scroll-track); }
.chat::-webkit-scrollbar { width: 10px; }
.chat::-webkit-scrollbar-track { background: var(--scroll-track); border-radius: 8px; }
.chat::-webkit-scrollbar-thumb { background: var(--scroll-thumb); border-radius: 8px; }
.chat::-webkit-scrollbar-thumb:hover { filter: brightness(0.95); }

/* ---- MESSAGE BLOCKS (bidi-robust) ---- */
.msg {
    scroll-snap-align: start;
    scroll-margin-top: 1px;  /* ensure previous item fully out of view */
    text-align: start;       /* follows dir (rtl => right, ltr => left) */
}

/* Force per-message bidi independent of container */
.msg[dir="rtl"] {
    direction: rtl;
    unicode-bidi: plaintext;
}
.msg[dir="ltr"] {
    direction: ltr;
    unicode-bidi: plaintext;
}

/* User bubble */
.bubble {
    color: var(--text-strong);
    font-weight: 600;
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 10px 12px;
    max-width: 80ch;
    white-space: pre-wrap;
    line-height: 1.55;
    margin-left: auto;
}
.bubble-user { background: var(--user); }

/* Assistant text (no bubble) */
.assistant {
    color: var(--text-strong);
    font-weight: 500;
    max-width: 80ch;
    white-space: pre-wrap;
    line-height: 1.6;
    margin-left: auto;
}

/* Fixed composer */
.footer-fixed {
    position: fixed;
    left: 0; right: 0; bottom: 0;
    background: var(--panel);
    border-top: 1px solid var(--border);
    z-index: 40;
    box-shadow: 0 -2px 10px rgba(0,0,0,0.06);
}

/* Input/Button (legacy helpers still used) */
.input {
    flex: 1;
    font-size: 16px;
    padding: 10px 12px;
    border: 1px solid var(--border);
    border-radius: 10px;
    background: var(--bg);
    color: var(--text-strong);
    font-weight: 600;
}
.input::placeholder { opacity: .85; }

.textarea {
    resize: none;
    overflow: hidden;    /* we auto-resize with JS */
    line-height: 1.5;
    max-height: 30vh;    /* safe cap */
}

.button {
    font-size: 16px;
    padding: 10px 14px;
    border: 1px solid var(--border);
    border-radius: 999px;
    background: #111827;
    color: white;
    cursor: pointer;
    box-shadow: var(--shadow);
    height: 44px;        /* keep constant size */
    align-self: flex-end;/* don't stretch with textarea */
}
.button[disabled] { background: #2d2d2d20; color: #6b7280; cursor: not-allowed; }

/* Code blocks are always LTR */
pre, code {
    direction: ltr;
    unicode-bidi: plaintext;
    background: var(--code-bg);
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    font-size: 0.95em;
}
pre { padding: 10px 12px; border-radius: 10px; overflow-x: auto; border: 1px solid var(--border); }

/* Floating “jump to latest” */
.jump-down {
    position: fixed;
    right: 24px;
    /* bottom set inline by Chat.tsx so it sits above composer */
    width: 44px;
    height: 44px;
    border-radius: 9999px;
    border: 1px solid var(--border);
    background: var(--panel);
    color: var(--text-strong);
    box-shadow: var(--shadow);
    display: grid;
    place-items: center;
    cursor: pointer;
    z-index: 45;
}
.jump-down:hover { filter: brightness(0.97); }

/* ---- Toasts ---- */
.toasts-wrap {
    position: fixed;
    top: 16px;
    right: 16px;
    left: auto;
    display: grid;
    gap: 8px;
    z-index: 9999;
    pointer-events: none;
}

.toast {
    pointer-events: auto;
    border: 1px solid var(--border);
    background: var(--panel);
    color: var(--text-strong);
    box-shadow: var(--shadow);
    border-radius: 12px;
    padding: 10px 12px;
    min-width: 260px;
    max-width: min(480px, 90vw);
    font-size: 14px;
    animation: toast-in .18s ease-out;
}
.toast.info { border-color: #60a5fa80; }
.toast.success { border-color: #34d39980; }
.toast.error { border-color: #ef444480; }

.toast-text { white-space: pre-wrap; }

@keyframes toast-in {
    from { opacity: 0; transform: translateY(-6px); }
    to   { opacity: 1; transform: translateY(0); }
}

/* Sidebar: fixed width, no horizontal scrollbar */
.sidebar {
    width: 320px;
    min-width: 320px;
    max-width: 320px;
    overflow-x: hidden;
}

/* Ensure the messages column never forces horizontal scrolling */
.chat.flex-1 { min-width: 0; }

/* Header symmetry (3 zones: left brand, center modes, right status/actions) */
.header-inner {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    align-items: center;
    gap: 12px;
}
.header-left { justify-self: start; }
.header-center { justify-self: center; }
.header-right { justify-self: end; display: flex; gap: 8px; align-items: center; }

/* Make sure the fixed viewport spans full width and never introduces horizontal scrollbars */
.chat-viewport { left: 0; right: 0; overflow: hidden; }
